import{x as E,b as l,V as d,e as o,ag as g,W as h,X as w,ae as C,av as S,aw as $,af as k,d as P,U as W,r as O,c as F,w as p,z as y,u as D,A as N,f as M,g as B,a8 as x,a9 as L,h as I,v as T,Q as A,ao as V,i as j,I as z}from"./index-031477aa.js";const Y={name:"WSchedule",props:{planList:{type:Array,default:[]},cardStatus:{type:Object,default:()=>({1:{title:"已过期",color:"#9CADADB7"},2:{title:"进行中",color:"#FF6200"},3:{title:"未开始",color:"#3291F8"}})},isFirstDayOfMondayOrSunday:{type:Number,default:1},hasNumExpend:{type:Number,default:2}},data(){return{weeks:["时段","一","二","三","四","五","六","日"],todayDate:"",months:[{date:"",showDate:"",timestamp:new Date().getTime(),isCurDate:!1}],curDate:new Date,nowDate:new Date}},watch:{isFirstDayOfMondayOrSunday:{handler(e){if(e>1){let s=["一","二","三","四","五","六","日"];const t=s.slice(e-1),r=s.slice(0,e-1);this.weeks=["时段",...t,...r]}},immediate:!0}},mounted(){this.getCurWeek()},methods:{formatDate(e){var s=e.getFullYear(),t=e.getMonth()+1,r=(t<10?"0"+t:t).toString(),n=(e.getDate()<10?"0"+e.getDate():e.getDate()).toString();return{year:s.toString(),month:r,day:n}},getCurDay(){var e=new Date,s=e.getFullYear(),t=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,r=e.getDate()<10?"0"+e.getDate():e.getDate();return`${s}-${t}-${r}`},handleExpand(e){e.isExpend=!e.isExpend},getWeek(e){this.curDate=new Date(e);const s=e.getDay();let t=0;this.isFirstDayOfMondayOrSunday<=s?t=this.isFirstDayOfMondayOrSunday:t=this.isFirstDayOfMondayOrSunday-7;const r=e.getDay()-t;e=this.addDate(e,r*-1);for(let n=0;n<7;n++){const{year:i,month:a,day:c}=this.formatDate(n===0?e:this.addDate(e,1));this.months.push({date:`${i}-${a}-${c}`,showDate:Number(c)+"",timestamp:new Date(`${i}-${a}-${c}`).getTime(),isCurDate:this.getCurDay()===`${i}-${a}-${c}`})}this.months.sort((n,i)=>n.timestamp-i.timestamp),delete this.months[0],this.todayDate=`${this.months[1].date} ~ ${this.months[this.months.length-1].date}`},addDate(e,s){return e.setDate(e.getDate()+s),e},getLastWeek(){const e=this.addDate(this.curDate,-7),{year:s,month:t,day:r}=this.formatDate(e),n={date:`${s}-${t}-${r}`,timestamp:new Date(`${s}-${t}-${r}`).getTime()};this.dealDate(e),this.$emit("changeWeek",n)},getCurWeek(){const{year:e,month:s,day:t}=this.formatDate(new Date),r={date:`${e}-${s}-${t}`,timestamp:new Date(`${e}-${s}-${t}`).getTime()};this.dealDate(new Date),this.$emit("changeWeek",r)},getNextWeek(){const e=this.addDate(this.curDate,7),{year:s,month:t,day:r}=this.formatDate(e),n={date:`${s}-${t}-${r}`,timestamp:new Date(`${s}-${t}-${r}`).getTime()};this.dealDate(e),this.$emit("changeWeek",n)},dealDate(e){this.months=[{date:"",showDate:"",timestamp:new Date().getTime(),isCurDate:!1}],this.getWeek(e);const s=this.getCurDay();this.months.forEach(t=>{t.isCurDate=t.date===s})},handleDetail(e){this.$emit("handleDetail",e)},handleCardDetail(e,s){this.$emit("handleCardDetail",{...e,...s})}}};const H={class:"course-week"},q={class:"week-top"},Q={class:"week-btn-wrap"},U={class:"w-today-date"},X={class:"w-choose-status"},G={class:"title"},J={class:"week-table"},K={class:"table-header"},R={class:"table-week"},Z={class:"w-table-date"},ee={class:"w-time-period-list"},te={class:"w-time-period-row"},ae={class:"w-time-period"},se={class:"w-row-day"},ne=["onClick"],ie=["onClick"],le=["onClick"],de=["onClick"],oe=["onClick"],re={key:1,class:"w-noMore"},ue=o("span",null,"暂无数据",-1),ce=[ue];function he(e,s,t,r,n,i){return l(),d("div",H,[o("div",q,[o("div",Q,[o("span",{onClick:s[0]||(s[0]=(...a)=>i.getLastWeek&&i.getLastWeek(...a))},"上周"),o("span",{onClick:s[1]||(s[1]=(...a)=>i.getCurWeek&&i.getCurWeek(...a))},"本周"),o("span",{onClick:s[2]||(s[2]=(...a)=>i.getNextWeek&&i.getNextWeek(...a))},"下周")]),o("span",U,g(n.todayDate),1),o("div",X,[(l(!0),d(h,null,w(t.cardStatus,a=>(l(),d("div",null,[o("span",{class:"square",style:C({background:a.color})},null,4),o("span",G,g(a.title),1)]))),256))])]),o("div",J,[o("div",K,[o("div",R,[(l(!0),d(h,null,w(n.weeks,(a,c)=>(l(),d(h,null,[c===0?(l(),d("span",{class:"w-first",key:c},g(a),1)):(l(),d("span",{key:c+""},g(a),1))],64))),256))]),o("div",Z,[(l(!0),d(h,null,w(n.months,(a,c)=>(l(),d(h,null,[c===0?(l(),d("span",{class:"w-first",key:c})):(l(),d("span",{key:c,class:S(["w-day-item",{"w-isCurDate":a&&a.isCurDate}])},g(`${a&&a.isCurDate,a&&a.showDate||""}`),3))],64))),256))])]),o("div",ee,[o("ul",te,[t.planList.length>0?(l(!0),d(h,{key:0},w(t.planList,(a,c)=>(l(),d("li",{class:"w-time-period-col",key:`period${c}`},[o("div",ae,g(a.timePeriod),1),o("div",se,[(l(!0),d(h,null,w(n.months,(u,b)=>(l(),d(h,null,[u?(l(),d("div",{key:`month${b}`,class:"w-things",onClick:m=>i.handleCardDetail(u,a)},[(l(!0),d(h,null,w(a.schedule,(m,ye)=>(l(),d(h,null,[(l(!0),d(h,null,w(m[u.date],(_,f)=>(l(),d(h,null,[m.isExpend?k("",!0):(l(),d(h,{key:0},[_.date===u.date&&f<t.hasNumExpend?(l(),d("div",{key:`thing${f}`,class:"w-thing-item",onClick:v=>i.handleDetail(_),style:C({background:t.cardStatus[_.status].color})},[$(e.$slots,"thing",{row:_})],12,ie)):k("",!0)],64)),m.isExpend?(l(),d(h,{key:1},[_.date===u.date?(l(),d("div",{key:`thing${f}`,class:"w-thing-item",onClick:v=>i.handleDetail(_),style:C({background:t.cardStatus[_.status].color})},[$(e.$slots,"thing",{row:_})],12,le)):k("",!0)],64)):k("",!0),m[u.date].length>t.hasNumExpend&&m[u.date].length-1===f&&!m.isExpend&&_.date===u.date?(l(),d("div",{key:2,class:"w_expand",onClick:v=>i.handleExpand(m)},"展开 ",8,de)):k("",!0),m[u.date].length>t.hasNumExpend&&m[u.date].length-1===f&&m.isExpend&&_.date===u.date?(l(),d("div",{key:3,class:"w_shrink",onClick:v=>i.handleExpand(m)},"收缩 ",8,oe)):k("",!0)],64))),256))],64))),256))],8,ne)):k("",!0)],64))),256))])]))),128)):(l(),d("div",re,ce))])])])])}const me=E(Y,[["render",he]]),De={style:{"margin-top":"40px"}},_e=P({__name:"mySchedulePage",setup(e){const s=W([""]);for(let n=1;n<20;n++)s.push("Item "+n);function t(n=0){var i=new Date,a=i.getFullYear(),c=i.getMonth()+1<10?"0"+(i.getMonth()+1):i.getMonth()+1;let u=i.getDate();return u+n>0?u=u+n<10?"0"+(i.getDate()+n):i.getDate()+n:u=u-n<10?"0"+(i.getDate()-n):i.getDate()-n,`${a}-${c}-${u}`}const r=O([{timePeriod:"1",schedule:[{isExpend:!1,[t()]:[{timePeriod:"8:00~10:00",date:t(),course:"大学英语",watchman:"井底的蜗牛",place:"测试地点",status:1},{timePeriod:"8:00~10:00",date:t(),course:"大学英语",watchman:"井底的蜗牛",place:"测试地点",status:2},{timePeriod:"8:00~10:00",date:t(),course:"大学英语",watchman:"井底的蜗牛",place:"测试地点",status:3}]},{isExpend:!1,[t(-1)]:[{id:1,timePeriod:"8:00~10:00",date:t(-1),course:"大学英语",watchman:"井底的蜗牛",place:"测试地点",status:1}]}]},{timePeriod:"2",schedule:[{isExpend:!1,[t()]:[{timePeriod:"12:00~14:00",date:t(),course:"大学英语",watchman:"井底的蜗牛",place:"测试地点",status:2},{timePeriod:"12:00~14:00",date:t(),course:"大学英语",watchman:"井底的蜗牛",place:"测试地点",status:3}]},{isExpend:!1,[t(-1)]:[{timePeriod:"12:00~14:00",date:t(-1),course:"大学英语",watchman:"井底的蜗牛",place:"测试地点",status:1},{timePeriod:"实验室1",date:t(-1),course:"大学英语",watchman:"井底的蜗牛",place:"测试地点",status:1},{timePeriod:"实验室1",date:t(-1),course:"大学英语",watchman:"井底的蜗牛",place:"测试地点",status:1}]}]},{timePeriod:"3",schedule:[]}]);return(n,i)=>(l(),F(D(z),null,{default:p(()=>[y(D(M),{style:{"background-color":"#f7f7f7"},class:"ion-no-border ion-padding"},{default:p(()=>[y(D(B),null,{default:p(()=>[y(D(x),{slot:"start"},{default:p(()=>[y(D(L),{text:"","default-href":"/tabs/study"})]),_:1}),y(D(I),null,{default:p(()=>[N("我的课表")]),_:1}),y(D(x),{slot:"end"},{default:p(()=>[y(D(T),null,{default:p(()=>[y(D(A),{icon:D(V)},null,8,["icon"])]),_:1})]),_:1})]),_:1})]),_:1}),y(D(j),{fullscreen:!0,class:"ion-padding"},{default:p(()=>[o("div",De,[y(me,{planList:r.value,isFirstDayOfMondayOrSunday:5,hasNumExpend:3},{thing:p(({row:a})=>[o("span",null,"时段："+g(a.timePeriod),1),o("span",null,"课程："+g(a.course),1),o("span",null,"值班员："+g(a.watchman),1),o("span",null,"地点："+g(a.place),1)]),_:1},8,["planList"])])]),_:1})]),_:1}))}});const pe=E(_e,[["__scopeId","data-v-ebc603ca"]]);export{pe as default};
